import{d as w,u as k,a as C,r as c,e as S,s as I,h as E,j as e,V as z,c as g,C as $}from"./index-C8yg4PaE.js";import{g as O}from"./images-Cz2n-uX2.js";import{H as R}from"./heart-BnUm9HUa.js";import{A as _}from"./arrow-right-A92xHp2q.js";const F=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],U=w("chevron-left",F),A="sozyola_tg_lang",x="sozyola_favorites",L=()=>{const l=k(),{bookId:n,unitId:i,wordIndex:r}=C(),[p,h]=c.useState(!1),[v]=c.useState(()=>localStorage.getItem(A)||"uz"),[u,d]=c.useState(!1),m=S.find(s=>s.id===Number(n)),a=m?.units.find(s=>s.id===Number(i)),t=a?.words[Number(r)];c.useEffect(()=>{I(()=>l(-1)),E()},[l]),c.useEffect(()=>{if(t)try{const s=JSON.parse(localStorage.getItem(x)||"[]");d(s.some(o=>o.word===t.word))}catch{d(!1)}},[t]);const b=()=>{if(!(!t||!m||!a))try{const s=JSON.parse(localStorage.getItem(x)||"[]"),o=s.findIndex(N=>N.word===t.word);o>=0?(s.splice(o,1),d(!1)):(s.push({word:t.word,meaning:t.meaning,meaningRu:t.meaningRu,definition:t.definition,example:t.example,partOfSpeech:t.partOfSpeech,image:t.image,bookId:m.id,unitId:a.id,wordIndex:Number(r)}),d(!0)),localStorage.setItem(x,JSON.stringify(s)),g.impact("light")}catch(s){console.error("Failed to toggle favorite:",s)}},y=s=>{const o=new SpeechSynthesisUtterance(s);o.lang="en-US",o.rate=.85,speechSynthesis.speak(o),g.selection()};if(!m||!a||!t)return e.jsx("div",{className:"h-full flex items-center justify-center",children:e.jsx("p",{style:{color:"var(--tg-hint)"},children:"Word not found"})});const f=O(t.image),j=v==="ru"&&t.meaningRu?t.meaningRu:t.meaning;return e.jsx("div",{className:"h-full overflow-y-auto pb-6 safe-area-bottom",children:e.jsxs("div",{className:"px-4 pt-4",children:[e.jsxs("div",{className:"rounded-2xl overflow-hidden mb-4",style:{backgroundColor:"var(--tg-section-bg)",border:"1px solid var(--tg-secondary-bg)"},children:[f&&!p?e.jsx("div",{className:"w-full h-48 overflow-hidden",style:{backgroundColor:"var(--tg-secondary-bg)"},children:e.jsx("img",{src:f,alt:t.word,className:"w-full h-full object-cover",onError:()=>h(!0)})}):e.jsx("div",{className:"w-full h-32 flex items-center justify-center",style:{backgroundColor:"var(--tg-secondary-bg)"},children:e.jsx("span",{className:"text-5xl opacity-50",children:"ðŸ“–"})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h1",{className:"text-2xl font-bold",style:{color:"var(--tg-link)"},children:t.word}),e.jsx("button",{onClick:()=>y(t.word),className:"p-2 rounded-full active:opacity-60",style:{backgroundColor:"var(--tg-secondary-bg)"},children:e.jsx(z,{size:18,style:{color:"var(--tg-button)"}})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.partOfSpeech&&e.jsx("span",{className:"text-xs px-2 py-1 rounded-full",style:{backgroundColor:"var(--tg-secondary-bg)",color:"var(--tg-hint)"},children:t.partOfSpeech}),e.jsx("button",{onClick:b,className:"p-2 rounded-full active:opacity-60",style:{backgroundColor:u?"#ef444420":"var(--tg-secondary-bg)"},children:e.jsx(R,{size:18,fill:u?"#ef4444":"none",style:{color:u?"#ef4444":"var(--tg-hint)"}})})]})]}),e.jsx("p",{className:"text-lg font-semibold mb-3",style:{color:"var(--tg-text)"},children:j}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide mb-1",style:{color:"var(--tg-hint)"},children:"Definition"}),e.jsx("p",{className:"text-sm",style:{color:"var(--tg-subtitle)"},children:t.definition})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide mb-1",style:{color:"var(--tg-hint)"},children:"Example"}),e.jsxs("p",{className:"text-sm italic",style:{color:"var(--tg-text)"},children:['"',t.example,'"']})]})]})]}),e.jsx("div",{className:"rounded-xl p-3 mb-4",style:{backgroundColor:"var(--tg-secondary-bg)"},children:e.jsxs("p",{className:"text-xs",style:{color:"var(--tg-hint)"},children:["ðŸ“š Book ",n," Â· Unit ",i," Â· Word ",Number(r)+1," of ",a.words.length]})}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("button",{onClick:()=>{const s=Number(r)-1;s>=0&&(g.selection(),l(`/word/${n}/${i}/${s}`))},disabled:Number(r)<=0,className:"flex-1 flex items-center justify-center gap-1 py-2.5 rounded-xl font-medium active:opacity-80 disabled:opacity-40",style:{backgroundColor:"var(--tg-secondary-bg)",color:"var(--tg-text)"},children:[e.jsx(U,{size:18}),"Previous"]}),e.jsxs("button",{onClick:()=>{const s=Number(r)+1;s<a.words.length&&(g.selection(),l(`/word/${n}/${i}/${s}`))},disabled:Number(r)>=a.words.length-1,className:"flex-1 flex items-center justify-center gap-1 py-2.5 rounded-xl font-medium active:opacity-80 disabled:opacity-40",style:{backgroundColor:"var(--tg-secondary-bg)",color:"var(--tg-text)"},children:["Next",e.jsx($,{size:18})]})]}),e.jsxs("button",{onClick:()=>l(`/unit/${n}/${i}`),className:"w-full flex items-center justify-center gap-2 py-3 rounded-xl font-medium active:opacity-80",style:{backgroundColor:"var(--tg-button)",color:"var(--tg-button-text)"},children:["View Full Unit",e.jsx(_,{size:18})]})]})})};export{L as WordDetailPage};
