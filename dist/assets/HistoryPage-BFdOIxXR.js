import{u as N,b as f,r as n,e as w,j as e,t as y,l as T,B as k,g as S}from"./index-BxJXOgmm.js";import{T as D}from"./trending-up-DNrwX8xW.js";import{C}from"./calendar-DOcNIl0B.js";function O(){const x=N(),{progress:h}=f(),[i,v]=n.useState("all"),g=n.useMemo(()=>{const s=[];return Object.entries(h.results).forEach(([r,t])=>{const[l,a]=r.split("-").map(Number),o=w.find(d=>d.id===l),m=o?.units.find(d=>d.id===a);o&&m&&t&&s.push({date:t.date||new Date().toISOString(),editionId:l,unitId:a,bookTitle:o.title,unitTitle:`Unit ${m.id}`,score:t.score||0,total:t.total||m.words.length,mode:"quiz"})}),s.sort((r,t)=>new Date(t.date).getTime()-new Date(r.date).getTime())},[h.results]),c=n.useMemo(()=>{const s=new Date;return g.filter(r=>{const t=new Date(r.date);switch(i){case"week":return s.getTime()-t.getTime()<=10080*60*1e3;case"month":return s.getTime()-t.getTime()<=720*60*60*1e3;default:return!0}})},[g,i]),u=n.useMemo(()=>{const s={};return c.forEach(r=>{const t=new Date(r.date).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"});s[t]||(s[t]=[]),s[t].push(r)}),s},[c]),p=n.useMemo(()=>{const s=c.length,r=c.reduce((a,o)=>a+o.score,0),t=c.reduce((a,o)=>a+o.total,0),l=t>0?Math.round(r/t*100):0;return{totalSessions:s,totalCorrect:r,totalQuestions:t,avgAccuracy:l}},[c]),b=s=>new Date(s).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),j=s=>{switch(s){case"flashcards":return"ðŸƒ";case"quiz":return"ðŸ§ ";case"recall":return"ðŸ’­";case"matching":return"ðŸ”—";case"multiple-choice":return"ðŸ“";case"scramble":return"ðŸ”€";case"fill-blank":return"ðŸ“‹";default:return"ðŸ“š"}};return e.jsxs("div",{className:"min-h-screen bg-[var(--tg-theme-bg-color)] pb-20",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-[var(--tg-theme-bg-color)] border-b border-[var(--tg-theme-hint-color)]/20 px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>x(-1),className:"p-2 -ml-2 rounded-full hover:bg-[var(--tg-theme-secondary-bg-color)]",children:e.jsx(y,{className:"w-5 h-5 text-[var(--tg-theme-text-color)]"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-6 h-6 text-blue-500"}),e.jsx("h1",{className:"text-xl font-bold text-[var(--tg-theme-text-color)]",children:"Practice History"})]})]})}),e.jsx("div",{className:"px-4 py-3 flex gap-2",children:["all","week","month"].map(s=>e.jsx("button",{onClick:()=>v(s),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${i===s?"bg-[var(--tg-theme-button-color)] text-[var(--tg-theme-button-text-color)]":"bg-[var(--tg-theme-secondary-bg-color)] text-[var(--tg-theme-hint-color)]"}`,children:s==="all"?"All Time":s==="week"?"This Week":"This Month"},s))}),e.jsx("div",{className:"px-4 mb-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-[var(--tg-theme-secondary-bg-color)]",children:[e.jsx(k,{className:"w-5 h-5 text-blue-500 mb-2"}),e.jsx("p",{className:"text-2xl font-bold text-[var(--tg-theme-text-color)]",children:p.totalSessions}),e.jsx("p",{className:"text-xs text-[var(--tg-theme-hint-color)]",children:"Sessions"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-[var(--tg-theme-secondary-bg-color)]",children:[e.jsx(D,{className:"w-5 h-5 text-green-500 mb-2"}),e.jsxs("p",{className:"text-2xl font-bold text-[var(--tg-theme-text-color)]",children:[p.avgAccuracy,"%"]}),e.jsx("p",{className:"text-xs text-[var(--tg-theme-hint-color)]",children:"Avg Accuracy"})]})]})}),Object.keys(u).length===0?e.jsxs("div",{className:"px-4 py-8 text-center",children:[e.jsx(S,{className:"w-12 h-12 text-[var(--tg-theme-hint-color)] mx-auto mb-3"}),e.jsx("p",{className:"text-[var(--tg-theme-hint-color)]",children:"No practice history yet"}),e.jsx("p",{className:"text-sm text-[var(--tg-theme-hint-color)] mt-1",children:"Complete a quiz to see your progress"})]}):e.jsx("div",{className:"px-4 space-y-6",children:Object.entries(u).map(([s,r])=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(C,{className:"w-4 h-4 text-[var(--tg-theme-hint-color)]"}),e.jsx("h3",{className:"text-sm font-semibold text-[var(--tg-theme-hint-color)]",children:s})]}),e.jsx("div",{className:"space-y-2",children:r.map((t,l)=>{const a=Math.round(t.score/t.total*100);return e.jsx("button",{onClick:()=>x(`/unit/${t.editionId}/${t.unitId}`),className:"w-full p-3 rounded-xl bg-[var(--tg-theme-secondary-bg-color)] text-left",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:j(t.mode)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-[var(--tg-theme-text-color)] truncate",children:t.bookTitle}),e.jsxs("p",{className:"text-xs text-[var(--tg-theme-hint-color)]",children:[t.unitTitle," â€¢ ",b(t.date)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`font-bold ${a>=80?"text-green-500":a>=60?"text-yellow-500":"text-red-500"}`,children:[a,"%"]}),e.jsxs("p",{className:"text-xs text-[var(--tg-theme-hint-color)]",children:[t.score,"/",t.total]})]})]})},l)})})]},s))})]})}export{O as default};
